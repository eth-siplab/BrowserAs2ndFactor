(()=>{"use strict";({534:function(){var e,t=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))((function(d,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function i(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?d(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};let s=null,n=null,d=null;const o=document.getElementById("totp-seed"),a=document.getElementById("save-seed"),i=document.getElementById("divider"),c=document.getElementById("totp-section"),l=document.getElementById("totp-code"),r=document.getElementById("copy-button"),u=document.getElementById("progress-bar"),m=document.getElementById("time-remaining");function v(){return t(this,void 0,void 0,(function*(){s&&(n&&clearInterval(n),d&&clearInterval(d),yield y(),n=window.setInterval(y,3e4),d=window.setInterval(p,100))}))}function y(){return t(this,void 0,void 0,(function*(){if(s)try{chrome.runtime.sendMessage({action:"generateTOTP"},(e=>{e&&e.code&&"error"!==e.code&&"Crypto Error"!==e.code?l.textContent=e.code:l.textContent="ERROR"}))}catch(e){console.error("Error generating TOTP:",e),l.textContent="ERROR"}}))}function p(){const e=Date.now(),t=Math.floor(e/1e3)%30,s=t/30*100,n=30-t;u.style.width=`${s}%`,m.textContent=`${n}s remaining`,0===t&&y()}document.addEventListener("DOMContentLoaded",(()=>t(void 0,void 0,void 0,(function*(){yield function(){return t(this,void 0,void 0,(function*(){chrome.storage.sync.get("totpSeed",(e=>{e.totpSeed&&(s=e.totpSeed,o.value="*".repeat(Math.min(e.totpSeed.length,20)),o.classList.add("masked"),a.classList.add("disabled"),a.disabled=!0,i.style.display="block",c.style.display="block",v())}))}))}()})))),null===(e=document.getElementById("save-seed"))||void 0===e||e.addEventListener("click",(()=>{const e=o.value;if(a.disabled||o.classList.contains("masked")&&e.startsWith("*"))return;if(!e.trim())return void alert("Please enter a TOTP seed!");if(!/^[A-Z2-7\s]+$/i.test(e))return void alert("Invalid seed format. Please use base32 characters only.");const t=e.toUpperCase().replace(/\s/g,"");s=t,chrome.storage.sync.set({totpSeed:t},(()=>{alert("TOTP seed saved!"),o.value="*".repeat(Math.min(t.length,20)),o.classList.add("masked"),a.classList.add("disabled"),a.disabled=!0,i.style.display="block",c.style.display="block",v()}))})),o.addEventListener("focus",(()=>{o.classList.contains("masked")&&(o.value="",o.classList.remove("masked"),o.placeholder="Enter new seed or leave empty to keep current",a.classList.remove("disabled"),a.disabled=!1)})),o.addEventListener("blur",(()=>{o.value.trim()||!s||o.classList.contains("masked")||(o.value="*".repeat(Math.min(s.length,20)),o.classList.add("masked"),o.placeholder="Enter seed",a.classList.add("disabled"),a.disabled=!0)})),o.addEventListener("input",(()=>{o.classList.contains("masked")||(a.classList.remove("disabled"),a.disabled=!1)})),r.addEventListener("click",(()=>t(void 0,void 0,void 0,(function*(){const e=l.textContent;if(e&&"------"!==e&&"ERROR"!==e)try{yield navigator.clipboard.writeText(e),r.classList.add("success"),r.style.backgroundColor="#28a745",l.classList.add("copied"),setTimeout((()=>{r.classList.remove("success"),r.style.backgroundColor="",l.classList.remove("copied")}),1e3)}catch(t){console.error("Failed to copy:",t);const s=document.createElement("textarea");s.value=e,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),r.classList.add("success"),r.style.backgroundColor="#28a745",l.classList.add("copied"),setTimeout((()=>{r.classList.remove("success"),r.style.backgroundColor="",l.classList.remove("copied")}),1e3)}})))),window.addEventListener("beforeunload",(()=>{n&&clearInterval(n),d&&clearInterval(d)}))}})[534]()})();